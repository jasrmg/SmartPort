{% extends "smartportApp/custom/custom-base.html" %}
<!---->
{% load static %}
<!---->
{% block title %} Submanifest Review {% endblock %}
<!---->
{% block head %}
<link
  rel="stylesheet"
  href="{% static 'custom/css/submanifest-review.css' %}"
/>
{% endblock %}
<!---->
{% block sidebar %}
<!-- Sidebar -->
<div class="sidebar">
  <div class="sidebar-header">
    <div class="logo">
      <i class="fas fa-anchor logo-icon"></i>
      <span class="logo-text">SmartPort</span>
      <button class="collapse-btn">
        <i class="fas fa-bars"></i>
      </button>
    </div>
  </div>

  <ul class="nav-menu">
    <li class="nav-item">
      <a href="{% url 'customs-dashboard' %}" class="nav-link">
        <i class="fas fa-tachometer-alt"></i>
        <span>Dashboard</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="" class="nav-link active">
        <i class="fas fa-file-alt"></i>
        <span>Submanifest Review</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="{% url 'review-history' %}" class="nav-link">
        <i class="fa-solid fa-clock-rotate-left"></i>
        <span>Review History</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="#" class="nav-link">
        <i class="fas fa-cog"></i>
        <span>Settings</span>
      </a>
      <ul class="nav-sub-menu">
        <li>
          <a href="#" id="sidebarChangePassword" class="nav-sub-link">
            <i class="fas fa-key"></i>
            <span>Change Password</span>
          </a>
        </li>
        <li>
          <a href="#" id="sidebarEditProfileBtn" class="nav-sub-link">
            <i class="fas fa-user-edit"></i>
            <span>Edit Profile</span>
          </a>
        </li>
      </ul>
    </li>
    <li class="nav-item">
      <a id="SBlogout-btn" class="nav-link">
        <i class="fas fa-sign-out-alt"></i>
        <span>Logout</span>
      </a>
    </li>
  </ul>
</div>
{% endblock %}
<!-- Main Content -->

{% block content %}
<div class="section">
  <div class="section-header">
    <h2 class="section-title">Pending For Review</h2>
  </div>

  <div class="table-responsive">
    <table class="custom-table">
      <thead>
        <tr>
          <th>
            <button class="sort-btn" data-column="0" data-order="none">
              Submanifest No. <i class="fas fa-sort"></i>
            </button>
          </th>
          <th>
            <button class="sort-btn" data-column="1" data-order="none">
              Consignee Name <i class="fas fa-sort"></i>
            </button>
          </th>
          <th>
            <button class="sort-btn" data-column="2" data-order="none">
              Submitted By <i class="fas fa-sort"></i>
            </button>
          </th>
          <th>
            <button class="sort-btn" data-column="3" data-order="none">
              Date Submitted <i class="fas fa-sort"></i>
            </button>
          </th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for submanifest in submanifests %}
        <tr>
          <td>{{ submanifest.submanifest_number }}</td>
          <td>{{ submanifest.consignee_name }}</td>
          <td>
            {{ submanifest.created_by.auth_user.first_name }}
            <!---->
            {{ submanifest.created_by.auth_user.last_name }}
          </td>
          <td>{{ submanifest.created_at|date:"M d, Y" }}</td>
          <td>
            <button
              class="btn-icon view"
              title="Review"
              data-submanifest-id="{{ submanifest.submanifest_id }}"
            >
              <i class="fas fa-eye"></i>
            </button>
            <button class="btn-icon accept" title="Approve">
              <i class="fas fa-check"></i>
            </button>
            <button class="btn-icon reject" title="Reject">
              <i class="fas fa-times"></i>
            </button>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="no-pending-submanifest">
            No pending submanifests found.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<div id="toast-container"></div>
{% endblock %}
<!---->
{% block modal %}
<!-- Reject Modal -->
<div id="rejectModal" class="modal-overlay">
  <div class="modal">
    <div class="modal-header">
      <h3>Reject Submanifest</h3>
    </div>
    <div class="modal-body">
      <form id="rejectForm">
        <input type="hidden" id="rejectSubmanifestId" />
        <textarea
          id="rejectNote"
          required
          rows="5"
          placeholder="Add Rejection Note"
        ></textarea>
        <div class="modal-actions">
          <button type="button" id="cancelRejectBtn" class="btn-cancel">
            Cancel
          </button>
          <button type="submit" class="btn-danger">Reject</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Approve Modal -->
<div id="approveModal" class="modal-overlay">
  <div class="modal">
    <div class="modal-header">
      <h3>Approve Submanifest</h3>
    </div>
    <div class="modal-body">
      <form id="approveForm">
        <input type="hidden" id="approveSubmanifestId" />
        <p>
          Are you sure you want to approve this submanifest? This action is
          irreversible.
        </p>
        <div class="modal-actions">
          <button type="button" id="cancelApproveBtn" class="btn-cancel">
            Cancel
          </button>
          <button type="submit" class="btn-update">Approve</button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
<!---->
{% block script %}
<script src="{% static 'custom/js/submanifest-review.js' %}"></script>
{% endblock %}
